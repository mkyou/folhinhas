require(dplyr)

dados = tibble::tribble(
  ~resp1, ~resp2,
  # PAG 1
  7, 1,
  6, 0,
  6, 0,
  4, 1,
  5, 1,
  6, 0,
  11, 1,
  8, 1,
  11, 0,
  5, 1,
  15, 0,
  4, 1,
  10, 0,
  NA, NA,
  NA, NA,
  3, 1, 
  11, 1,
  8, 0,
  9, 0,
  3, 1,
  6, 1,
  2, 1,
  3, 1,
  2, 0,
  3, 1,
  4, 1,
  3, 1,
  NA,NA,
  NA,NA,
  NA,NA,
  # NAO TIREI FOTO DA PAG 2
  NA, NA,
  # PAG 3
  7, 0,
  9, 1, 
  8, 1,
  4, 1,
  9, 0,
  5, 0,
  6, 0,
  7, 1,
  NA, NA,
  2, 1,
  5, 1,
  5, 1,
  7, 0,
  9, 1,
  5, 1,
  4, 1,
  6, 1,
  3, 1,
  1, 1,
  5, 1,
  3, 1,
  4, 0,
  5, 1, 
  3, 1,
  2, 0
  
)


x = c(0.01066234, 0.11838122, 0.28159760, 0.37791111, 0.45641839, 
      0.46273696, 0.47303642, 0.47355603, 0.57419017,
      0.58926270, 0.61224386, 0.67389683, 0.71108641, 0.72494837, 
      0.72879702, 0.82666013, 0.86811324, 1.06210391,
      1.10924718, 1.13743334, 1.20354086, 1.30560153, 1.30629847, 
      1.43721348, 1.48282965, 1.54522126, 1.55224165,
      1.78063844, 1.79730017, 1.84748014, 1.89582503, 1.96674800, 
      2.00189207, 2.01706692, 2.04929574, 2.08753101,
      2.12210745, 2.14656307, 2.21012886, 2.55496017, 2.58817970, 
      2.60877668, 2.63193922, 2.70252163, 2.79535848,
      2.83486939, 2.84572729, 2.84752077, 2.92775664, 2.93445584, 
      3.00753601, 3.06639749, 3.25172437, 3.28480159,
      3.38913223, 3.41715696, 3.46358270, 3.51544984, 3.60271162, 
      3.91205274, 3.96276937, 3.97990929, 4.04798376,
      4.06688620, 4.08937867, 4.15224074, 4.15418616, 4.31963370, 
      4.39973850, 4.41722670)

y = c(1.19886161, 1.86851406, 3.73074918, 0.81457311, 
      0.89643173, 2.23794180, 0.41529407, 0.91279475, 2.42297281,
      0.23767914, 2.15229094, 0.29247875, 2.17273933, 
      3.65718455, 3.79393346, 0.05897958, 2.01231914, 3.07700223,
      3.74959336, 0.29070542, 0.45334741, 1.27587888, 
      1.45517537, 0.39119104, 3.00887316, 0.82995990, 1.33008540,
      0.37996911, 2.82255654, 0.66156501, 1.53958101, 
      3.10249737, 1.62382334, 1.96677094, 0.46743303, 3.29892386,
      2.87341346, 2.98804279, 1.66146547, 3.64702261, 
      1.33738885, 0.80106181, 0.70243087, 2.13002210, 0.85673278,
      1.06487288, 1.54815195, 0.80874964, 3.00964437, 
      0.05533958, 0.90167086, 2.53376481, 2.88749117, 0.14049202,
      0.64983181, 2.92877091, 2.21843013, 3.44513529, 
      2.03748428, 1.46735417, 3.83487876, 2.07711152, 1.65472058,
      1.48277583, 0.97219025, 0.93684990, 0.78121633, 
      0.72725797, 2.05513636, 1.18245359)


dados = data.frame(x[1:56] |> round(2), y[1:56] |> round(2), dados)
colnames(dados) = c("x", "y", "contagem", "sombra")
dados$densidade = NA

head(dados)

#função para calcular área em cm²
calcula_area = function(x, y) {

  area = 0
  if (x >= .30 & y >= .30) {
    area = 10000 * .30 * .30 
  }
  else if (x < .30 & y >= .30) {
    area = x * .30 * 10000 
  }
  else if (x >= .30 & y < .30) {
    area = y * .30 * 10000
  }
  else{
    area = x * y * 10000
  }
  
  return(area)
}

dados$area = mapply(function(x,y) calcula_area(x, y), 
                    dados$x, dados$y)

head(dados)

dados = dados |> mutate(densidade = contagem/area)
dados = na.omit(dados)

dados |> glimpse()

write_csv(dados, "./data/dados_tratados.csv")
